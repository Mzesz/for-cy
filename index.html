<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Valentine</title>

<!-- PWA -->
<link rel="manifest" href="manifest.json" />
<meta name="theme-color" content="#ff4d6d" />

<style>
* { box-sizing: border-box; }

body {
  margin: 0;
  height: 100vh;
  font-family: "Poppins", Arial, sans-serif;
  display: flex;
  justify-content: center;
  align-items: center;
  overflow: hidden;
  background: url("valentines.png") no-repeat center center / cover;
}

#app {
  width: 92%;
  max-width: 420px;
  background: rgba(255,255,255,.95);
  border-radius: 22px;
  padding: 20px;
  text-align: center;
  box-shadow: 0 25px 50px rgba(0,0,0,.35);
}

.hidden { display: none; }

button {
  padding: 14px 20px;
  font-size: 17px;
  border: none;
  border-radius: 14px;
  margin: 6px;
  cursor: pointer;
  transition: .2s;
}
button:hover { transform: scale(1.06); }

.yes { background:#4CAF50; color:white; }
.no  { background:#f44336; color:white; position:relative; }

.heart {
  position:fixed;
  width:34px;
  height:34px;
  background-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 29.6"><path fill="%23ff4d6d" d="M16 29.6c-1-.6-21-12.6-16-20C5.7 5.6 10.3 4 16 11c5.7-7 10.3-5.4 16-2.6 5 7.4-15 19.6-16 20z"/></svg>');
  animation:fall linear infinite;
}

@keyframes fall {
  from { transform:translateY(-60px); }
  to { transform:translateY(110vh); }
}

#noMessage {
  margin-top: 12px;
  font-size: 14px;
  color: #ff4d6d;
  min-height: 18px;
}

#chat {
  position:fixed;
  bottom:16px;
  width:92%;
  max-width:420px;
  background:white;
  border-radius:20px;
  padding:14px;
  box-shadow:0 12px 30px rgba(0,0,0,.3);
}

.msg {
  max-width:80%;
  padding:10px 14px;
  margin:8px 0;
  border-radius:16px;
}
.left { background:#eee; }
.right { background:#ffb6c1; margin-left:auto; }

.reply {
  display:inline-block;
  background:#ffd1dc;
  padding:8px 12px;
  border-radius:12px;
  margin:6px;
  cursor:pointer;
}

#game {
  position:relative;
  height:200px;
  margin-top:10px;
  overflow:hidden;
  border-radius:14px;
  background:#fff0f5;
}

.catch {
  position:absolute;
  font-size:28px;
  cursor:pointer;
}

#ending {
  white-space:pre-line;
  font-size:15px;
  line-height:1.6;
}
</style>
</head>

<body>
<audio id="teleportSound" src="teleport.mp3"></audio>
<audio id="music" src="love-music.mp3" loop></audio>

<div id="app">
  <div id="intro">
    <h2 id="question"></h2>
    <button class="yes" id="yesBtn">YES ğŸ’–</button>
    <button class="no" id="noBtn">NO ğŸ˜ˆ</button>
    <div id="noMessage"></div>
  </div>

  <div id="mini" class="hidden">
    <h3>Catch 5 hearts ğŸ’˜</h3>
    <div id="game"></div>
  </div>

  <div id="date" class="hidden">
    <h3>Choose our date ğŸ’•</h3>
    <button onclick="chooseDate('ğŸ· Proper Dinner Date')">ğŸ· Proper Dinner Date</button>
    <button onclick="chooseDate('ğŸ¬ Movie Date')">ğŸ¬ Movie</button>
    <button onclick="chooseDate('â˜• Coffee')">â˜• Coffee</button>
    <button onclick="chooseDate('ğŸ® Arcade / games')">ğŸ® Arcade/games</button>
    <button onclick="chooseDate('ğŸ³ Bowling')">ğŸ³ Bowling</button>
    <button onclick="chooseDate('ğŸ¡ Carnival')">ğŸ¡ Carnival</button>
</div>
  <div id="ending"></div>
</div>

<div id="chat" class="hidden"></div>

<script>
/* CONFIG */
const name = 'Cy';

/* STATE */
let noClicks = 0;
let heartsCaught = 0;
let dateChoice = '';
let hesitationScore = 0;

const noMessages = [
  "Hmmâ€¦ are you sure? ğŸ¤¨",
  "That NO sounded uncertain ğŸ˜",
  "You hesitated. I felt it.",
  "At this point youâ€™re just flir   ting ğŸ˜Œ",
  "Okay wow, commitment to NO is impressive ğŸ˜‚",
  "Iâ€™m running out of escape routesâ€¦ ğŸ« "
];

function showNoMessage(text) {
  let m = document.getElementById('noMessage');
  if (!m) {
    m = document.createElement('div');
    m.id = 'noMessage';
    m.style.marginTop = '10px';
    m.style.fontSize = '14px';
    m.style.opacity = '0.85';
    intro.appendChild(m);
  }
  m.innerText = text;
}


/* ELEMENTS */
const question = document.getElementById('question');
const noBtn = document.getElementById('noBtn');
const yesBtn = document.getElementById('yesBtn');
const noMessage = document.getElementById('noMessage');
const intro = document.getElementById('intro');
const mini = document.getElementById('mini');
const chat = document.getElementById('chat');
const date = document.getElementById('date');
const ending = document.getElementById('ending');
const teleportSound = document.getElementById('teleportSound');
const music = document.getElementById('music');

/* INIT */
question.innerText = `Hi ${name} ğŸ¤­, will you be my Valentine? ğŸ’˜`;

/* NO BUTTON â€“ EMOTION AWARE ğŸ˜ˆ */
noBtn.addEventListener('click', () => {
  noClicks++;

  teleportSound.currentTime = 0;
  teleportSound.play();

  showNoMessage(
    noMessages[Math.min(noClicks - 1, noMessages.length - 1)]
  );

  // emotion-aware: slows down as clicks increase
  const emotionFactor = Math.max(0.25, 1 - noClicks * 0.12);
  noBtn.style.transition = `${emotionFactor}s`;

  if (noClicks >= 7) {
    noBtn.disabled = true;
    noBtn.style.opacity = '0.6';
    showNoMessage("Okay okay ğŸ˜µâ€ğŸ’« Iâ€™m tiredâ€¦ NO is on cooldown now. Just click yes please ğŸ¥º");
    return;
  }

  noBtn.style.position = 'absolute';
  noBtn.style.left = Math.random() * 80 + '%';
  noBtn.style.top  = Math.random() * 80 + '%';
});

/* YES */
yesBtn.addEventListener('click', () => {
  music.play();
  intro.classList.add('hidden');
  mini.classList.remove('hidden');
  startMiniGame();
});

/* MINI GAME */
function startMiniGame() {
  const game = document.getElementById('game');
  const spawn = setInterval(() => {
    const h = document.createElement('div');
    h.className = 'catch';
    h.innerText = 'ğŸ’–';
    h.style.left = Math.random() * 85 + '%';
    h.style.top = Math.random() * 80 + '%';
    h.onclick = () => {
      heartsCaught++;
      h.remove();
      if (heartsCaught >= 5) {
        clearInterval(spawn);
        mini.classList.add('hidden');
        startChat();
      }
    };
    game.appendChild(h);
  }, 700);
}

/* CHAT */
function startChat() {
  chat.classList.remove('hidden');
  addMsg('Oooohâ€¦ you actually said YES ğŸ˜ğŸ’–', 'left');
  setTimeout(() => {
    addMsg('Sabi ko na ehh crush mo koğŸ˜â€¦ so bakit YES? HAHAHH ', 'left');
    showReplies();
  }, 1200);
}

function addMsg(text, side) {
  const m = document.createElement('div');
  m.className = `msg ${side}`;
  m.innerText = text;
  chat.appendChild(m);
}

function showReplies() {
  const replies = [
    'Because wala lang bat ba HAHAHAğŸ˜œ',
    'Kasi ang cute mo hihi ğŸ˜',
    'Kasi gusto ko lang ğŸ˜ğŸ’–'
  ];replies.forEach(t => {
    const r = document.createElement('div');
    r.className = 'reply';
    r.innerText = t;
    r.onclick = () => reply(t);
    chat.appendChild(r);
  });
}

function reply(text) {
  document.querySelectorAll('.reply').forEach(e => e.remove());
  addMsg(text,'right');

  setTimeout(() => {
    addMsg('Yesss! lezgooo ğŸ˜†ğŸ‰', 'left');
    setTimeout(() => {
      addMsg('Soâ€¦ where should we go first? ğŸ’•', 'left');

          setTimeout(() => {
        chat.classList.add('hidden');      // hide chatbox
        date.classList.remove('hidden');   // show date choices
      }, 3000);
    }, 1000);
  }, 1000);
}


/* DATE */
function chooseDate(d) {
  dateChoice = d;
  date.classList.add('hidden');
  rainHearts();
  finish();
}

/* HEART RAIN */
function rainHearts() {
  for (let i=0;i<50;i++){
    const h=document.createElement('div');
    h.className='heart';
    h.style.left=Math.random()*100+'vw';
    h.style.animationDuration=(Math.random()*2+3)+'s';
    document.body.appendChild(h);
  }
}

/* ENDING â€“ HEARTFELT LETTER (PLACEHOLDER TEXT) */
function finish(){
  chat.classList.add('hidden');

  // Secret endings
  let secret = '';
  if (noClicks === 0) secret = '\n\n';
  if (hesitationScore > 6) secret = '\n\n';

  ending.innerText = `Dear ${name},\n\nOkay, yes â€” this is a little cringey ğŸ˜‚ğŸ’¦  
But if it made you smile even a little ğŸ˜ğŸ’–, then I think it did its job!\n\n
We havenâ€™t known each other for long , but Iâ€™m super curious about you
I want you to know Iâ€™m serious about getting to know you
So if youâ€™re up for it, letâ€™s go on a few fun dates, laugh a lot , and see where things go ğŸš€ğŸ’«.\n\nâ€” from your super friend,  
Redd ğŸ˜ğŸ’Œ.${secret}`;
}

/* PWA SERVICE WORKER */
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('sw.js');
}
</script>
</body>
</html>
